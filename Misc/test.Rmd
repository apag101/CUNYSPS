---
title: "test"
author: "Anthony Pagan"
date: "December 31, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
knitr::kable(
summary(cars),
caption = "Test Table"
)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(ggplot2)
library(tidyverse)
best_in_class <- mpg %>%
    group_by(class) %>%
    filter(row_number(desc(hwy))==1)

ggplot(mpg, aes(displ, hwy))+
    geom_point(aes(color=class))+
    geom_point(size=3, shape=1, data=best_in_class)+
    ggrepel::geom_label_repel(aes(label=model),
                              data= best_in_class)
```


```{r}
library(tidyverse)
library(modelr)
library(ggplot2)
library(tibble)

models<- tibble(
    a1= runif(250, -20, 40),
    a2= runif(250, -5, 5)
)
model1 <- function(a, data) 
{
    a[1] + data$x * a[2]
}

measure_distance <- function(mod, data)
{
    diff <- data$y - model1(mod, data)
    sqrt(mean(diff^2))
}

sim1_dist <-function(a1, a2)
{
    measure_distance(c(a1, a2), sim1)
}
models <- models %>%
    mutate(dist = map2_dbl(a1, a2, sim1_dist))

ggplot(models, aes(a1, a2))+
    geom_point(
        data = filter(models, rank(dist) <= 10),
        size = 4, color = "red"
    )+
    geom_point(aes(colour = -dist)
)

```


