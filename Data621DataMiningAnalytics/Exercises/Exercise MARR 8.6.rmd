---
title: "Data 621 ELMR Exercise 3.4"
author: "Anthony Pagan"
date: "10/27/2019"
output: html_document
css: style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```



```{r}
#ELMR 3.4
data(africa, package="faraway")
names(africa)
head(africa)
```

### LM shows oligarch, pollib and parties as being significant. Plot shows a trend and not spread of data.

```{r}
lmod<-lm(miltcoup ~., africa)
plot(predict(lmod),residuals(lmod),xlab="Fitted",ylab="Residuals")
summary(lmod)
```

### stripchart shows some outliers on the size variable

```{r}
stripchart(africa)
```

### set linear model with sqrt of response variable while adding log to predictor variable size. Parties is not longer signficant

```{r}
lmod<-lm(sqrt(miltcoup) ~.-size+log(size), family=poisson, africa)
plot(predict(lmod),residuals(lmod),xlab="Fitted",ylab="Residuals")
summary(lmod)
```

### Persons F-test shows pollit and parties with higher AIC values 
```{r}
lmod<-lm(miltcoup ~., africa)
halfnorm(residuals(lmod))
(dp<- sum(residuals(lmod,type="pearson")^2)/lmod$df.res)
summary(lmod, dispersion=dp)
drop1(lmod,test="F")
```



```{r}
lmod<-glm(miltcoup ~oligarchy+pollib+parties, family=poisson,  africa)
summary(lmod)
plot(predict(lmod),residuals(lmod),xlab="Fitted",ylab="Residuals")
halfnorm(residuals(lmod))
```

### With oligarch and polib
```{r}
lmod<-glm(miltcoup ~oligarchy+pollib, family=poisson,  africa)
summary(lmod)
plot(predict(lmod),residuals(lmod),xlab="Fitted",ylab="Residuals")
halfnorm(residuals(lmod))
```

### With Parties and polib
```{r}
lmod<-glm(miltcoup ~pollib+parties, family=poisson,  africa)
summary(lmod)
plot(predict(lmod),residuals(lmod),xlab="Fitted",ylab="Residuals")
halfnorm(residuals(lmod))

```
